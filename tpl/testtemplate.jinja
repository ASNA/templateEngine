import peewee, os
import xlrd, datetime
import export_to_excel

{% for i in imports %}
{{i.import}}
{% endfor %}


class {{config.classname}}:
    def __init__(self):
{% for m in map %}
    {% if loop.first %}
        self.excel_map = { "{{m.name}}" : "{{m.letter}}",
    {% elif loop.last %}
                           "{{m.name}}" : "{{m.letter}}" }
    {% else %}
                           "{{m.name}}" : "{{m.letter}}",
    {% endif %}
{% endfor %}




{% if config.needs_owner %}
include owner
{% endif %}


{{config.needs_owner}}
{{config.model}}
{{config.classname}}
"{{config.excel_spreadsheet}}"
{{config.excel_sheetname}}

{% for item in map %}
    {{item.name}}
{% endfor %}


{% for cols in columns %}
    {{ cols.name }}
    {% if cols.mapped_name %}
    uses a mapped name
    {% endif %}
{% endfor %}